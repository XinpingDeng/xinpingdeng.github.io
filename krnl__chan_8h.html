<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>gxcorr: /data/BALDR_1/den15c/gxcorr/gxcorr/krnl_chan.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">gxcorr
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_61fa3639f67dbf40431b13d81e35ca34.html">gxcorr</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">krnl_chan.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;inttypes.h&gt;</code><br />
<code>#include &quot;<a class="el" href="gxcorr__constants_8h_source.html">gxcorr_constants.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for krnl_chan.h:</div>
<div class="dyncontent">
<div class="center"><img src="krnl__chan_8h__incl.png" border="0" usemap="#a_2data_2BALDR__1_2den15c_2gxcorr_2gxcorr_2krnl__chan_8h" alt=""/></div>
<map name="a_2data_2BALDR__1_2den15c_2gxcorr_2gxcorr_2krnl__chan_8h" id="a_2data_2BALDR__1_2den15c_2gxcorr_2gxcorr_2krnl__chan_8h">
<area shape="rect" title=" " alt="" coords="23,5,213,47"/>
<area shape="rect" title=" " alt="" coords="5,95,92,121"/>
<area shape="rect" href="gxcorr__constants_8h.html" title=" " alt="" coords="116,95,261,121"/>
</map>
</div>
</div>
<p><a href="krnl__chan_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a53494865d31ac998ebe84f827eb152b7"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a53494865d31ac998ebe84f827eb152b7"><td class="memTemplItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="krnl__chan_8h.html#a53494865d31ac998ebe84f827eb152b7">krnl_chan</a> (int nchan, int chan0, int nchan_keep, const T *input, T *output)</td></tr>
<tr class="memdesc:a53494865d31ac998ebe84f827eb152b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">A overloaded template kernel to.  <a href="krnl__chan_8h.html#a53494865d31ac998ebe84f827eb152b7">More...</a><br /></td></tr>
<tr class="separator:a53494865d31ac998ebe84f827eb152b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a53494865d31ac998ebe84f827eb152b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53494865d31ac998ebe84f827eb152b7">&#9670;&nbsp;</a></span>krnl_chan()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">__global__ void krnl_chan </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nchan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chan0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nchan_keep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A overloaded template kernel to. </p>
<ol type="1">
<li>fft shift to FFT output to put DC at bin 0</li>
<li>keep required fine channels</li>
<li>fft shift kept fine channels to put DC at middle The output will be the input of a reverse FFT, which will get time series with a narrower band. Currently it works with a single coarse channel, multiple antennas and 2 polarisations, we may need to extend it to support multiple coarse channels in future.</li>
</ol>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Complex data type, which can be half2 or float2</td></tr>
  </table>
  </dd>
</dl>
<p>Here assumes that we need a fftshift to get fine frequency channels in right order Not sure if we need another fftshift before we do reverse FFT, currently assume that we do not need another fftshift, no we do not need another fftshift Currently implementation output data in frequency channel ascending order for odd nyquist zones, but descending order for even nyquist zones need to update chan_keep as chan_keep = nchan_keep-1-chan_keep to get ascending order for even nyquist zones</p>
<p>To setup this kernel on host, blockDim.x and gridDim.x are used to define number of channels <em>nchan</em>, where blockDim.x is number of threads (<em>nthread</em>) per CUDA thread block and gridDim.x is <code>nchan/nthread</code>, gridDim.y is number of FFTs <em>nfft</em> and gridDim.z is number of antennas <em>nant</em> </p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Kernel dims   </th><th class="markdownTableHeadNone">Value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">gridDim.z   </td><td class="markdownTableBodyNone">nant    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">gridDim.y   </td><td class="markdownTableBodyNone">nfft    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">gridDim.x   </td><td class="markdownTableBodyNone">nchan/nthread    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">blockDim.x   </td><td class="markdownTableBodyNone">nthread   </td></tr>
</table>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">input</td><td>FFT output, which is in order [NANT NPOL NFFT NCHAN], where NCHAN is number of fine channels of each coarse channel </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">chan0</td><td>The first kept fine channel, it is the index of shifted channels before oversampled channel edge removing </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nchan_keep</td><td>Number of fine channels to keep </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td>Kept data in order [NANT NPOL NFFT NCHAN_KEEP], where NCHAN_KEEP is number of kept fine channels </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
